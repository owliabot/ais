{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "urn:ais:0.0.2:workflow",
  "title": "AIS Workflow (ais-flow/0.0.2)",
  "$ref": "#/$defs/Root_1",
  "$defs": {
    "extensions_7": {
      "type": "object",
      "additionalProperties": {}
    },
    "meta_3": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$"
        },
        "description": {
          "type": "string"
        },
        "extensions": {
          "$ref": "#/$defs/extensions_7"
        }
      },
      "required": [
        "name",
        "version"
      ],
      "additionalProperties": false
    },
    "Def_12": {
      "type": "object",
      "properties": {
        "protocol": {
          "type": "string",
          "pattern": "^[a-z0-9-]+@\\d+\\.\\d+\\.\\d+$"
        },
        "path": {
          "type": "string",
          "minLength": 1
        },
        "integrity": {
          "type": "string"
        },
        "extensions": {
          "$ref": "#/$defs/extensions_7"
        }
      },
      "required": [
        "protocol",
        "path"
      ],
      "additionalProperties": false
    },
    "imports_10": {
      "type": "object",
      "properties": {
        "protocols": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Def_12"
          }
        },
        "extensions": {
          "$ref": "#/$defs/extensions_7"
        }
      },
      "additionalProperties": false
    },
    "requires_pack_16": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "version": {
          "type": "string"
        },
        "extensions": {
          "$ref": "#/$defs/extensions_7"
        }
      },
      "required": [
        "name",
        "version"
      ],
      "additionalProperties": false
    },
    "Def_20": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string"
        },
        "required": {
          "type": "boolean"
        },
        "default": {},
        "example": {},
        "description": {
          "type": "string"
        },
        "extensions": {
          "$ref": "#/$defs/extensions_7"
        }
      },
      "required": [
        "type"
      ],
      "additionalProperties": false
    },
    "inputs_19": {
      "type": "object",
      "additionalProperties": {
        "$ref": "#/$defs/Def_20"
      }
    },
    "Union36_0_36": {
      "type": "object",
      "properties": {
        "lit": {}
      },
      "required": [
        "lit"
      ],
      "additionalProperties": false
    },
    "Union38_1_38": {
      "type": "object",
      "properties": {
        "ref": {
          "type": "string"
        }
      },
      "required": [
        "ref"
      ],
      "additionalProperties": false
    },
    "Union40_2_40": {
      "type": "object",
      "properties": {
        "cel": {
          "type": "string"
        }
      },
      "required": [
        "cel"
      ],
      "additionalProperties": false
    },
    "constraints_48": {
      "type": "object",
      "additionalProperties": {}
    },
    "detect_43": {
      "type": "object",
      "properties": {
        "kind": {
          "type": "string",
          "enum": [
            "choose_one",
            "best_quote",
            "best_path",
            "protocol_specific"
          ]
        },
        "provider": {
          "type": "string"
        },
        "candidates": {
          "type": "array",
          "items": {}
        },
        "constraints": {
          "$ref": "#/$defs/constraints_48"
        },
        "requires_capabilities": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "extensions": {
          "$ref": "#/$defs/extensions_7"
        }
      },
      "required": [
        "kind"
      ],
      "additionalProperties": false
    },
    "Union42_3_42": {
      "type": "object",
      "properties": {
        "detect": {
          "$ref": "#/$defs/detect_43"
        }
      },
      "required": [
        "detect"
      ],
      "additionalProperties": false
    },
    "object_53": {
      "type": "object",
      "additionalProperties": {
        "$ref": "#/$defs/Lazy_35"
      }
    },
    "Union52_4_52": {
      "type": "object",
      "properties": {
        "object": {
          "$ref": "#/$defs/object_53"
        }
      },
      "required": [
        "object"
      ],
      "additionalProperties": false
    },
    "Union54_5_54": {
      "type": "object",
      "properties": {
        "array": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Lazy_35"
          }
        }
      },
      "required": [
        "array"
      ],
      "additionalProperties": false
    },
    "Lazy_35": {
      "anyOf": [
        {
          "$ref": "#/$defs/Union36_0_36"
        },
        {
          "$ref": "#/$defs/Union38_1_38"
        },
        {
          "$ref": "#/$defs/Union40_2_40"
        },
        {
          "$ref": "#/$defs/Union42_3_42"
        },
        {
          "$ref": "#/$defs/Union52_4_52"
        },
        {
          "$ref": "#/$defs/Union54_5_54"
        }
      ]
    },
    "args_34": {
      "type": "object",
      "additionalProperties": {
        "$ref": "#/$defs/Lazy_35"
      }
    },
    "Def_57": {
      "type": "object",
      "properties": {
        "expr": {
          "$ref": "#/$defs/Lazy_35"
        },
        "extensions": {
          "$ref": "#/$defs/extensions_7"
        }
      },
      "required": [
        "expr"
      ],
      "additionalProperties": false
    },
    "calculated_overrides_56": {
      "type": "object",
      "additionalProperties": {
        "$ref": "#/$defs/Def_57"
      }
    },
    "retry_61": {
      "type": "object",
      "properties": {
        "interval_ms": {
          "type": "integer",
          "exclusiveMinimum": 0
        },
        "max_attempts": {
          "type": "integer",
          "exclusiveMinimum": 0
        },
        "backoff": {
          "type": "string",
          "enum": [
            "fixed"
          ]
        },
        "extensions": {
          "$ref": "#/$defs/extensions_7"
        }
      },
      "required": [
        "interval_ms"
      ],
      "additionalProperties": false
    },
    "Def_27": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string"
        },
        "type": {
          "type": "string",
          "enum": [
            "query_ref",
            "action_ref"
          ]
        },
        "chain": {
          "type": "string",
          "pattern": "^(eip155|solana|cosmos|bip122|aptos|sui):[a-zA-Z0-9._-]+$"
        },
        "protocol": {
          "type": "string",
          "pattern": "^[a-z0-9-]+@\\d+\\.\\d+\\.\\d+$"
        },
        "query": {
          "type": "string"
        },
        "action": {
          "type": "string"
        },
        "args": {
          "$ref": "#/$defs/args_34"
        },
        "calculated_overrides": {
          "$ref": "#/$defs/calculated_overrides_56"
        },
        "deps": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "condition": {
          "$ref": "#/$defs/Lazy_35"
        },
        "assert": {
          "$ref": "#/$defs/Lazy_35"
        },
        "assert_message": {
          "type": "string"
        },
        "until": {
          "$ref": "#/$defs/Lazy_35"
        },
        "retry": {
          "$ref": "#/$defs/retry_61"
        },
        "timeout_ms": {
          "type": "integer",
          "exclusiveMinimum": 0
        },
        "extensions": {
          "$ref": "#/$defs/extensions_7"
        }
      },
      "required": [
        "id",
        "type",
        "protocol"
      ],
      "additionalProperties": false
    },
    "approvals_67": {
      "type": "object",
      "additionalProperties": {}
    },
    "hard_constraints_69": {
      "type": "object",
      "additionalProperties": {}
    },
    "policy_66": {
      "type": "object",
      "properties": {
        "approvals": {
          "$ref": "#/$defs/approvals_67"
        },
        "hard_constraints": {
          "$ref": "#/$defs/hard_constraints_69"
        },
        "extensions": {
          "$ref": "#/$defs/extensions_7"
        }
      },
      "additionalProperties": false
    },
    "simulate_72": {
      "type": "object",
      "additionalProperties": {
        "type": "boolean"
      }
    },
    "preflight_71": {
      "type": "object",
      "properties": {
        "simulate": {
          "$ref": "#/$defs/simulate_72"
        },
        "extensions": {
          "$ref": "#/$defs/extensions_7"
        }
      },
      "additionalProperties": false
    },
    "outputs_74": {
      "type": "object",
      "additionalProperties": {
        "$ref": "#/$defs/Lazy_35"
      }
    },
    "Root_1": {
      "type": "object",
      "properties": {
        "schema": {
          "const": "ais-flow/0.0.3"
        },
        "meta": {
          "$ref": "#/$defs/meta_3"
        },
        "default_chain": {
          "type": "string",
          "pattern": "^(eip155|solana|cosmos|bip122|aptos|sui):[a-zA-Z0-9._-]+$"
        },
        "imports": {
          "$ref": "#/$defs/imports_10"
        },
        "requires_pack": {
          "$ref": "#/$defs/requires_pack_16"
        },
        "inputs": {
          "$ref": "#/$defs/inputs_19"
        },
        "nodes": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Def_27"
          }
        },
        "policy": {
          "$ref": "#/$defs/policy_66"
        },
        "preflight": {
          "$ref": "#/$defs/preflight_71"
        },
        "outputs": {
          "$ref": "#/$defs/outputs_74"
        },
        "extensions": {
          "$ref": "#/$defs/extensions_7"
        }
      },
      "required": [
        "schema",
        "meta",
        "nodes"
      ],
      "additionalProperties": false
    }
  }
}
